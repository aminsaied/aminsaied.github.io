"use strict";(self.webpackChunkaminsaied=self.webpackChunkaminsaied||[]).push([[7697],{3905:(e,t,r)=>{r.d(t,{Zo:()=>s,kt:()=>m});var a=r(7294);function n(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function l(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function o(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?l(Object(r),!0).forEach((function(t){n(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):l(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function i(e,t){if(null==e)return{};var r,a,n=function(e,t){if(null==e)return{};var r,a,n={},l=Object.keys(e);for(a=0;a<l.length;a++)r=l[a],t.indexOf(r)>=0||(n[r]=e[r]);return n}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)r=l[a],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}var p=a.createContext({}),u=function(e){var t=a.useContext(p),r=t;return e&&(r="function"==typeof e?e(t):o(o({},t),e)),r},s=function(e){var t=u(e.components);return a.createElement(p.Provider,{value:t},e.children)},c={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},d=a.forwardRef((function(e,t){var r=e.components,n=e.mdxType,l=e.originalType,p=e.parentName,s=i(e,["components","mdxType","originalType","parentName"]),d=u(r),m=n,h=d["".concat(p,".").concat(m)]||d[m]||c[m]||l;return r?a.createElement(h,o(o({ref:t},s),{},{components:r})):a.createElement(h,o({ref:t},s))}));function m(e,t){var r=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var l=r.length,o=new Array(l);o[0]=d;var i={};for(var p in t)hasOwnProperty.call(t,p)&&(i[p]=t[p]);i.originalType=e,i.mdxType="string"==typeof e?e:n,o[1]=i;for(var u=2;u<l;u++)o[u]=r[u];return a.createElement.apply(null,o)}return a.createElement.apply(null,r)}d.displayName="MDXCreateElement"},9950:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>p,contentTitle:()=>o,default:()=>c,frontMatter:()=>l,metadata:()=>i,toc:()=>u});var a=r(7462),n=(r(7294),r(3905));const l={title:"Private Wheels",sidebar_position:2},o=void 0,i={unversionedId:"dsref/azure/docker/private-wheel",id:"dsref/azure/docker/private-wheel",title:"Private Wheels",description:"Install a private python package from a wheel file.",source:"@site/docs/dsref/azure/docker/private-wheel.md",sourceDirName:"dsref/azure/docker",slug:"/dsref/azure/docker/private-wheel",permalink:"/docs/dsref/azure/docker/private-wheel",draft:!1,tags:[],version:"current",sidebarPosition:2,frontMatter:{title:"Private Wheels",sidebar_position:2},sidebar:"dsrefSidebar",previous:{title:"Azure ML Docker Examples",permalink:"/docs/dsref/azure/docker/azure-docker-examples"},next:{title:"Docusaurus",permalink:"/docs/dsref/docusaurus"}},p={},u=[{value:"Step 1: Build the wheel",id:"step-1-build-the-wheel",level:3},{value:"Step 2: Upload to Azure storage account",id:"step-2-upload-to-azure-storage-account",level:3},{value:"Step 3: dockerfile",id:"step-3-dockerfile",level:3}],s={toc:u};function c(e){let{components:t,...r}=e;return(0,n.kt)("wrapper",(0,a.Z)({},s,r,{components:t,mdxType:"MDXLayout"}),(0,n.kt)("p",null,"Install a private python package from a wheel file."),(0,n.kt)("p",null,"Problem: You have a python package you wish to install on your Docker image\nbut the source code is not publicly available (e.g., the code is not yet ready\nto be shared but the docker build process is public)."),(0,n.kt)("h3",{id:"step-1-build-the-wheel"},"Step 1: Build the wheel"),(0,n.kt)("p",null,"Build wheel for your package e.g."),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-bash"},"python setup.py build --build-base . bdist_wheel -d . --universal\n")),(0,n.kt)("p",null,"This will produce a wheel file , e.g. ",(0,n.kt)("inlineCode",{parentName:"p"},"<my-package>-0.0.1-py2.py3-none-any.whl"),"."),(0,n.kt)("p",null,"You can install this with"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-bash"},"pip install <my-package>-0.0.1-py2.py3-none-any.whl\n")),(0,n.kt)("h3",{id:"step-2-upload-to-azure-storage-account"},"Step 2: Upload to Azure storage account"),(0,n.kt)("p",null,"A simple way to do this is via Azure Storage Explorer."),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"Upload the file to your (private!) storage account"),(0,n.kt)("li",{parentName:"ul"},"Generate a SAS token and copy the url: it should be of the form:")),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-bash"},"https://<storage-account>.blob.core.windows.net/<container-name>/<path-on-storage/to/>/<my-package>-0.0.1-py2.py3-none-any.whl?<SAS-token>\n")),(0,n.kt)("h3",{id:"step-3-dockerfile"},"Step 3: dockerfile"),(0,n.kt)("p",null,"We can use ",(0,n.kt)("inlineCode",{parentName:"p"},"curl")," to download and ",(0,n.kt)("inlineCode",{parentName:"p"},"pip")," to install the wheel. Don't forget to delete the wheel\nafterwards."),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-dockerfile"},"# dockerfile\nFROM <container-registry>.azurecr.io/<image-name>:<tag>\n\nRUN apt-get -y update; apt-get -y install curl\nRUN mkdir -p /tmp/wheels\nRUN  curl <url-with-sas-token> --output /tmp/wheels/<my-package>-0.0.1-py2.py3-none-any.whl\nRUN pip install /tmp/wheels/<my-package>-0.0.1-py2.py3-none-any.whl\nRUN rm -rf /tmp/wheels/\n...\n")),(0,n.kt)("p",null,"Notes:"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("inlineCode",{parentName:"li"},"apt-get")," needs to be given the ",(0,n.kt)("inlineCode",{parentName:"li"},"-y")," flag"),(0,n.kt)("li",{parentName:"ul"},"make sure the path ",(0,n.kt)("inlineCode",{parentName:"li"},"curl")," writes to exists with ",(0,n.kt)("inlineCode",{parentName:"li"},"mkdir -p /tmp/wheels")),(0,n.kt)("li",{parentName:"ul"},"remember to delete the wheel file at the end")))}c.isMDXComponent=!0}}]);